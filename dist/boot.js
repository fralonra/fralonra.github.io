!function(){"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function i(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function n(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&h(t,i)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,i){return(h=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function a(t,i,e){return(a=r()?Reflect.construct:function(t,i,e){var n=[null];n.push.apply(n,i);var s=new(Function.bind.apply(t,n));return e&&h(s,e.prototype),s}).apply(null,arguments)}function o(t){var i="function"==typeof Map?new Map:void 0;return(o=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(t))return i.get(t);i.set(t,n)}function n(){return a(t,arguments,s(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,t)})(t)}function c(t,i){return!i||"object"!=typeof i&&"function"!=typeof i?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}var l=function(){function i(e,n){t(this,i),this.name=e,this.ctx=n}return e(i,[{key:"start",value:function(){}},{key:"show",value:function(){}},{key:"hide",value:function(){}}]),i}(),u=function(){function i(){t(this,i),this.list=Object.create(null),this.current=null}return e(i,[{key:"add",value:function(t){t.hulu=this,this.list[t.name]=t}},{key:"switch",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=this.list[t];e instanceof l&&(e.started||e.start(),this.current&&(i?this.current.destroy():this.current.hide()),e.show(),this.current=e)}}]),i}(),f=function(){function i(e){t(this,i),this.ctx=e,this.start=null,this.list=[],this.callbackId=null}return e(i,[{key:"add",value:function(t){this.list.push(t)}},{key:"clear",value:function(){this.list=[]}},{key:"run",value:function(){var t=this;this.callbackId=window.requestAnimationFrame((function(i){t.update(i)}))}},{key:"update",value:function(t){this.start||(this.start=t);var i=!0,e=!1,n=void 0;try{for(var s,h=this.list[Symbol.iterator]();!(i=(s=h.next()).done);i=!0){s.value.update(this.ctx,this.start,t)}}catch(t){e=!0,n=t}finally{try{i||null==h.return||h.return()}finally{if(e)throw n}}this.list.every((function(t){return t.end}))||this.run()}},{key:"stop",value:function(){window.cancelAnimationFrame(this.callbackId)}}]),i}(),d=function(i){function e(){var i;return t(this,e),(i=c(this,s(e).call(this))).end=!1,i}return n(e,i),e}(o(EventTarget)),v=function(){function i(e){t(this,i),this.target=e,this.list=Object.create(null)}return e(i,[{key:"add",value:function(t,i){var e=this.list[t];e||(e=[],this.list[t]=e),e.push(i),this.target.addEventListener(t,i)}},{key:"clear",value:function(t){if(t){var i=this.list[t];if(i){var e=!0,n=!1,s=void 0;try{for(var h,r=i[Symbol.iterator]();!(e=(h=r.next()).done);e=!0){var a=h.value;this.target.removeEventListener(t,a)}}catch(t){n=!0,s=t}finally{try{e||null==r.return||r.return()}finally{if(n)throw s}}this.list[t]=[]}}else for(var o=0,c=Object.keys(this.list);o<c.length;o++){var l=c[o];this.clear(l)}}}]),i}(),y=[{label:"Rona",command:"rona",action:function(){window.open("https://fralonra.github.io/rona","_blank")}}],x=[{label:"Reboot",action:function(){window.location.reload()}}],w=function(i){function h(i){var e;return t(this,h),(e=c(this,s(h).call(this,"MENU",i))).index=0,e.entries=y.filter((function(t){return t.label})).concat(x),e.em=null,e}return n(h,i),e(h,[{key:"show",value:function(){this.initStatic(),this.initEvents()}},{key:"initStatic",value:function(){this.ctx.font="".concat(16,"px sans"),this.ctx.textBaseline="top";for(var t=0;t<this.entries.length;t++){var i=this.entries[t],e=96+24*t;if(t!==this.index)this.ctx.fillStyle="#ffffff";else{var n=this.ctx.measureText(i.label);this.ctx.fillStyle="#ffffff",this.ctx.fillRect(56,e-4,n.width+8,24),this.ctx.fillStyle="#000000"}this.ctx.fillText(i.label,60,e)}}},{key:"initEvents",value:function(){var t=this;this.em=new v(window);var i=function(){t.ctx.clearRect(0,0,t.ctx.canvas.width,t.ctx.canvas.height),t.initStatic()};this.em.add("keydown",(function(e){switch(e.keyCode){case 38:--t.index<0&&(t.index=t.entries.length-1),i();break;case 40:++t.index>=t.entries.length&&(t.index=0),i();break;case 13:t.entries[t.index].action&&t.entries[t.index].action()}}))}},{key:"hide",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.em.clear()}},{key:"destroy",value:function(){this.hide()}}]),h}(l),p=1e3*(3.2*Math.random()+.32),g=function(){function i(e){var n=e.x,s=void 0===n?0:n,h=e.y,r=void 0===h?0:h,a=e.r,o=void 0===a?6:a,c=e.color,l=void 0===c?"#ffffff":c;t(this,i),this.x=s,this.y=r,this.r=o,this.color=l}return e(i,[{key:"draw",value:function(t){t.clearRect(this.x-this.r,this.y-this.r,2*this.r,2*this.r),t.save(),t.beginPath(),t.arc(this.x,this.y,this.r,0,2*Math.PI),t.closePath();var i=t.createRadialGradient(this.x,this.y,0,this.x,this.y,this.r);i.addColorStop(.4,this.color),i.addColorStop(1,this.color+"00"),t.fillStyle=i,t.fill(),t.restore()}}]),i}(),m=function(i){function h(i,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return t(this,h),(n=c(this,s(h).call(this))).width=Math.min(160,.9*i),n.left=(i-n.width)/2,n.top=3*e/4,n.lastUpdate=0,n.dots=[],n.inited=!1,n.highlightDotIndex=0,n.initDots(r),n}return n(h,i),e(h,[{key:"initDots",value:function(t){for(var i=this.width/t,e=(i-12)/2,n=0;n<t;++n){var s=new g({x:this.left+n*i+e+6,y:this.top+6});n===this.highlightDotIndex&&(s.color="#ff4012"),this.dots.push(s)}}},{key:"changeHighlightDotColor",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#ffffff";this.dots[this.highlightDotIndex].color=i,this.dots[this.highlightDotIndex].draw(t)}},{key:"update",value:function(t,i,e){if(!this.end){if(this.lastUpdate||(this.lastUpdate=e),e-i>p)return this.end=!0,void this.dispatchEvent(new Event("end"));(e-this.lastUpdate>800||!this.inited)&&(this.updateDots(t),this.lastUpdate=e)}}},{key:"updateDots",value:function(t){if(this.inited)this.changeHighlightDotColor(t),this.highlightDotIndex=this.highlightDotIndex>=this.dots.length-1?0:this.highlightDotIndex+1,this.changeHighlightDotColor(t,"#ff4012");else{var i=!0,e=!1,n=void 0;try{for(var s,h=this.dots[Symbol.iterator]();!(i=(s=h.next()).done);i=!0){s.value.draw(t)}}catch(t){e=!0,n=t}finally{try{i||null==h.return||h.return()}finally{if(e)throw n}}this.inited=!0}}}]),h}(d),k=function(i){function h(i){var e;return t(this,h),(e=c(this,s(h).call(this,"SPLASH",i))).anime=null,e}return n(h,i),e(h,[{key:"show",value:function(){this.initStatic(),this.initAnime()}},{key:"initStatic",value:function(){this.ctx.font="18px sans",this.ctx.textAlign="center",this.ctx.fillText("You are on the way",this.ctx.canvas.width/2,3*this.ctx.canvas.height/4-32),this.ctx.textAlign="start"}},{key:"initAnime",value:function(){var t=this;this.anime=new f(this.ctx);var i=new m(this.ctx.canvas.width,this.ctx.canvas.height);i.addEventListener("end",(function(){t.hide(),document.body.removeChild(document.getElementById("boot")),window.dispatchEvent(new Event("booted"))})),this.anime.add(i),this.anime.run()}},{key:"hide",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.anime.stop()}}]),h}(l),b=1e3*(2.2*Math.random()+.22),S=function(i){function h(i,e){var n;return t(this,h),(n=c(this,s(h).call(this))).width=.309*i,n.height=24,n.x=(i-n.width)/2,n.y=3*e/4,n}return n(h,i),e(h,[{key:"update",value:function(t,i,e){if(!this.end){t.fillStyle="#ffffff",t.strokeStyle="#ffffff";var n=e-i;if(n>b)return this.end=!0,void this.dispatchEvent(new Event("end"));t.strokeRect(this.x,this.y,this.width,this.height),t.fillRect(this.x,this.y,this.width*n/b,this.height)}}}]),h}(d),E=function(i){function h(i){var e;return t(this,h),(e=c(this,s(h).call(this,"BOOT",i))).anime=null,e.em=null,e}return n(h,i),e(h,[{key:"start",value:function(){this.hulu.add(new w(this.ctx)),this.hulu.add(new k(this.ctx))}},{key:"show",value:function(){this.initStatic(),this.initAnime(),this.initEvents()}},{key:"initStatic",value:function(){var t="F8 = Boot Menu";this.ctx.font="16px sans",this.ctx.fillStyle="#ffffff";var i=this.ctx.measureText(t);this.ctx.fillText(t,this.ctx.canvas.width-48-i.width,48),t="Booting from the cloud",this.ctx.font="18px sans",this.ctx.textAlign="center",this.ctx.fillText(t,this.ctx.canvas.width/2,3*this.ctx.canvas.height/4-32),this.ctx.textAlign="start"}},{key:"initAnime",value:function(){var t=this;this.anime=new f(this.ctx);var i=new S(this.ctx.canvas.width,this.ctx.canvas.height);i.addEventListener("end",(function(){t.hulu.switch("SPLASH")})),this.anime.add(i),this.anime.run()}},{key:"initEvents",value:function(){var t=this;this.em=new v(window);this.em.add("keydown",(function(i){119===i.keyCode&&t.hulu.switch("MENU")}))}},{key:"hide",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.anime.stop(),this.em.clear()}}]),h}(l),O=function(){function i(e){t(this,i),this.ctx=e,this.hulu=new u,this.hulu.add(new E(e))}return e(i,[{key:"start",value:function(){this.hulu.switch("BOOT")}}]),i}();!function(){window.POWER_ON=performance.now();var t=document.getElementById("boot").getContext("2d");t.canvas.width=window.innerWidth,t.canvas.height=window.innerHeight,new O(t).start()}()}();
